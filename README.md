# jbnu-wp-team

2019년. 2학년 1학기. Windows Programming. 윈도우즈프로그래밍.

## 1. Development

### 1-1. Summary

C# 기반의 ***키보드 런치 패드(Keyboard Launch Pad)*** 윈도우 애플리케이션 개발.

### 1-2. Environment

C#, Visual Studio

## 2. Project Proposal

### 2-1. Project Name

키보드 런치 패드(Keyboard Launch Pad)

### 2-2. Team Info

김용현, 서민택, 이상승 (총 3명)

### 2-3. About the project

#### 2-3-1. 런치 패드(Launch Pad)란?

![Launch Pad](./Docs/README/1.png)
![Launch Pad](./Docs/README/2.png)

런치 패드(Launch Pad)라는 악기가 있습니다. 간략히 설명하면, 위 사진에서 보이는 동그라미 혹은 네모 버튼에 각각의 사운드 소스(Sound Source) 즉, 소리 음원을 할당한 후, 해당 버튼을 눌러 특정 소리를 내게 하는 악기입니다.

#### 2-3-2. 런치 패드(Launch Pad) 사용 목적

런치 패드는 크게 2가지 목적으로 사용됩니다.

첫째로, 음악 프로듀서들이 미디(MIDI) 혹은 시퀀싱(Sequencing) 작업을 할 때, 작업의 흐름을 좀 더 원할하고 용이하게 하기 위해 사용하는 경우입니다.

둘째로, 유튜브(Youtube)등의 동영상 플랫폼에서 자주 볼 수 있는 퍼포먼스(Performance) 용도로 사용하는 경우입니다.

저희는 프로그램을 개발할 때 전자보다 후자의 경우에 더 집중하였고, 편리하고 간단한 조작방법과 UI를 통하여 입문자분들도 쉽게 접근할 수 있게 하였습니다.

#### 2-3-3. 프로그램 개발 동기

키보드 런치 패드 프로그램 개발 동기에는 크게 2가지 이유가 있습니다.

첫째로, 비용 문제입니다. 이는 ***런치 패드 기기 자체***, 그리고 여기에 사용되는 사운드 소스를 관리하는 데 필요한 ***DAW***(Digital Audio Workstation, 음악 제작 편집 소프트웨어 프로그램)의 높은 가격대로 인해 발생합니다. ***런치 패드 기기 자체***의 가격은 약 20-40만원, 이를 관리하는 ***DAW*** 역시 약 30-80만원 선으로 높은 가격대를 형성합니다. 따라서, 런치 패드를 간단한 퍼포먼스 혹은 놀이, 오락의 개념으로 접근하고자 하는 분들에게 해당 가격대는 부담으로 다가올 수 있습니다.

둘째로, 어려운 조작 방법입니다. 런치 패드 하드웨어의 경우에는 악기 치고는 간단한 조작방법으로 별 문제가 없을 수 있지만, DAW의 경우에는 입문자 혹은 초보자분들이 접근하기에는 어려움이 있습니다. DAW의 런치 패드 소프트웨어의 사용 방법을 보면 상당히 복잡합니다. 이는 소프트웨어가 샘플러(Sampler)의 역할을 겸하고 있어, 파형을 편집하고 이펙터(Effector)를 사용할 수 있게 하는 다양한 노브(Knob) 및 파라미터(Parameter)들이 존재하기 때문입니다. 이러한 복잡성은 초보자나 입문자분들에게 진입장벽으로 작용할 수 있습니다. (아래 사진 참고)

![Battery 4](./Docs/README/3.png)

#### 2-3-4. 프로그램 개요

위 내용들을 바탕으로 키보드 런치 패드(Keyboard Launch Pad) 프로그램을 구상하게 되었습니다. 이는 키보드의 버튼을 런치 패드의 버튼처럼 대신 사용하는 것으로, 키보드 버튼을 '타이핑'하거나 '좌클릭' 할 경우, 해당하는 소리가 하나씩 나게 해주는 프로그램입니다. 아래와 같은 3가지 부분을 큰 뼈대로 하여 세부 내용을 구현하였습니다.

1. 음악적 지식이 없는 초보자도 쉽게 이용할 수 있는 편리하고 직관적인 UI
2. 예쁜 외관 디자인과 퍼포먼스 용도로도 사용할 수 있는 화려한 UI
3. 놀이와 오락 퍼포먼스 용도에 적합한 정도의 꼭 필요한 기능들만 넣은 미니멀리즘

#### 2-3-5. 관련 프로그램/서비스 조사 결과

아래 프로그램들을 통해 BANK 기능, PLAY 기능 및 구조에 대한 아이디어를 얻었습니다.

Software

1. Native Instruments – Battery 4
2. Image Line – Drumaxx
3. Ableton Live – DrumSynth Abstract

Hardware

1. Novation – LaunchPad MK2
2. Native Instruments – MASCHINE MIKRO

#### 2-3-6. 개발 일정

- 2019년 5월 2주차 (5/07 - 5/12): 디자인 프로그래밍(XAML)
- 2019년 5월 3주차 (5/13 - 5/19): 구조 프로그래밍(C#)
- 2019년 5월 4주차 (5/20 - 5/26): 프로그램 버그 수정 및 완성도 점검
- 2019년 5월 5주차 (5/27 - 6/02): 발표준비

## 3. Requirements Specification

### 3-1. UI Design

UI 디자인은 크게 '레이아웃 디자인'과 '버튼 컬러 디자인'으로 나누어져 있습니다.

#### 3-1-1. 레이아웃 디자인

![Layout Design](./Docs/README/4.png)

위 키보드 레이아웃과 같은 동글동글한 모양의 버튼들을 키보드 모양과 동일하게 배치합니다. 위 키보드 레이아웃의 행은 6개인데, 이 중 제일 위쪽 행은 'BANK' 기능, 가운데 4개의 행은 'PLAY' 기능, 제일 아래쪽 행은 'MENU' 기능으로 활용합니다.

레이아웃 디자인의 핵심은 버튼의 전체적인 배치와 모서리가 둥근 직사각형 모양의 버튼을 구현하는 것에 있습니다.

#### 3-1-2. 버튼 컬러 디자인

![Button Color Design](./Docs/README/5.png)

실제 런치패드의 경우, 버튼을 누르면 해당하는 버튼과 주위 버튼들이 예쁜 모양을 그리면서 빛나며, 이를 통해 화려한 시각적 효과가 나타납니다. 이는 퍼포먼스 용도를 고려한 것이라 할 수 있습니다.

버튼 컬러 디자인의 핵심은 사운드를 재생하기 위하여 버튼을 클릭하거나 타이핑 하였을 때, 버튼 주변의 색깔이 변하는 것에 있습니다. 버튼 주위로 시각적 효과를 줄 수 있는 빛나는 부분을 만들어, 해당 버튼을 누를 때 마다 버튼이 반짝일 수 있도록 합니다.

### 3-2. Button Functions

UI의 모든 부분은 버튼으로 이루어져 있으며, 버튼을 'PLAY', 'BANK', 'MENU' 3가지 유형으로 분류합니다.

또한, 각각의 버튼은 '좌클릭', '우클릭', '키보드 타이핑' 3가지 이벤트에 따라 동작합니다.

#### 3-2-1. PLAY Button

PLAY 버튼의 가장 큰 역할은 '소리의 재생' 입니다.

##### 3-2-1-1. 좌클릭 O

해당 이벤트가 발생하면 '소리의 재생'이 이루어집니다. 여기서 재생되는 소리는 우리가 불러온 사운드 소스이며, 어떤 소스를 불러오고 사용할지는 우클릭 이벤트에서 고를 수 있습니다.

##### 3-2-1-2. 우클릭 O

해당 이벤트가 발생하면 '메뉴 버튼'이 등장합니다. 우클릭을 통한 메뉴 버튼으로 각각의 버튼과 사운드 소스를 관리할 수 있습니다.

1. `Load`: 사운드 소스 불러오기

    이 기능은 'Drag & Drop' 기능으로도 구현합니다. 사용하고자 하는 사운드 소스가 있을 때, 해당 소스를 'Drag & Drop' 한 후 원하는 버튼으로 끌어오면 해당 소스가 별도의 Load 버튼 없이도 Load 됩니다.

    또한 불러온 사운드 소스들은 windows `C:\` 상의 `PadSource`라는 폴더에 BANK 단위로 저장됩니다.

1. `Save`: 사운드 소스 저장하기

    이 기능은 자신이 불러온 사운드 소스를 다시 원하는 위치에 저장할 수 있게 해줍니다.

1. `Check`: 사운드 소스 파일명 확인하기

    이 기능의 경우에는 'Hovering' 기능으로도 구현할 예정입니다. 해당 버튼 위에 마우스를 갖다 댔을 때 어떤 사운드 소스를 이용하고 있나 바로 확인할 수 있습니다.

1. `Volume`: 사운드 소스 볼륨 조절

    소리의 크기를 조절할 수 있게 해줍니다. UI 좌측 하단에 슬라이더가 나오게 되며, OK 버튼 누르면 사라지게 됩니다..

1. `Panning`: 사운드 소스 패닝(소리의 좌우 균형) 조절

    소리가 좌측에 위치할 것인지, 우측에 위치할 것인지 소리의 균형을 조절할 수 있게 해줍니다.

1. `SpeedRatio`

    소리 음원의 재생속도를 결정합니다. 노브를 우측에 둘수록 소리의 배속이 빨라지며, 노브를 좌측에 둘수록 소리의 배속이 느려집니다.

1. `Color`: 버튼 UI 색상 변경 기능

    버튼을 눌렀을 때 반짝이는 색상을 지정합니다. 배경색과 테두리색을 정할 수 있습니다. 색상을 기본색으로 초기화 할 수도 있고, 버튼 하나만 색상을 변경할 것인지 혹은 모두 변경할 것인지의 여부도 지정할 수 있습니다. 변경한 색은 데이터 베이스에 저장됩니다.

1. `NonClickColor`: 버튼 UI 색상 변경 기능

    버튼을 누르지 않았을 때, 기본적으로 보이는 색상을 지정합니다. 이 역시 배경색과 테두리색을 정할 수 있습니다.

##### 3-2-1-3. 타이핑 O (해당 키를 타이핑 했을 때)

좌클릭 이벤트와 동일합니다.

#### 3-2-2. BANK Button

BANK 버튼은 '소리 묶음의 저장' 역할을 합니다. 만약, Q라는 키에 A라는 소리가 저장되어 있으면, Q를 누르게 되면 항상 A라는 소리만 재생됩니다. 하지만, BANK를 이용하면 이는 상황에 따라 달라집니다. 1번 BANK의 Q에 A라는 소리를 저장해 두고, 2번 BANK의 Q에 B라는 소리를 저장해 둔 후, BANK만 바꿔준다면 A와 B라는 소리를 모두 Q라는 버튼을 통해 이용할 수 있습니다.

BANK 버튼에는 빛나는 부분은 없으며, 해당 버튼이 눌려있다는 표시만 할 것입니다.

BANK는 `F1`부터 `F12`까지 총 12개를 이용할 수 있습니다.

##### 3-2-2-1. 좌클릭 O

BANK를 변경합니다. BANK는 1-12번까지 존재합니다.

##### 3-2-2-2. ~~우클릭 X~~

##### 3-2-2-3. 타이핑 O (해당 키를 타이핑 했을 때)

좌클릭 이벤트와 동일합니다.

#### 3-2-3. MENU Button

MENU 버튼에는 각각 `Stop`, `Repeat`, `Record` 3가지 기능이 있습니다.

##### 3-2-3-1. 좌클릭 O

1. `Stop`

    재생중인 모든 소리의 정지.

1. `Repeat`

    반복 재생 기능. 현재 사운드소스의 재생이 끝나면 자동으로 사운드소스를 다시 재생합니다.

1. `Record`

    소리 녹음 기능. 버튼을 통해 저장할 위치를 지정하고, 지정된 위치에 녹음된 소리를 저장합니다.

##### 3-2-3-2. ~~우클릭 X~~

##### 3-2-3-3. 타이핑 O (해당 키를 타이핑 했을 때)

좌클릭 이벤트와 동일합니다.

### 3-3. Other Functions

#### 3-3-1. API 연동

1. SoundCloud 연동을 통하여 내가 만든 음원을 조금 더 쉽게 공유하고, 런치 패드를 사용할때 필요한 음원들을 더 쉽게 참고할 수 있게 합니다.

2. 음원탐색 사이트인 BEATPORT를 통하여 EDM 계열 음악을 더 쉽게 탐색할 수 있게 합니다.

## 4. Implementaion

시연 동영상 등 상세 내역은 [PPT](./Docs/PPT.pptx)를 참고해주세요.

![6](./Docs/README/6.png)

### 4-1. 목차

![7](./Docs/README/7.png)

### 4-2. 소프트웨어 소개

![8](./Docs/README/8.png)
![9](./Docs/README/9.png)
![10](./Docs/README/10.png)
![11](./Docs/README/11.png)
![12](./Docs/README/12.png)
![13](./Docs/README/13.png)
![14](./Docs/README/14.png)
![15](./Docs/README/15.png)
![16](./Docs/README/16.png)
![17](./Docs/README/17.png)
![18](./Docs/README/18.png)
![19](./Docs/README/19.png)
![20](./Docs/README/20.png)

### 4-3. 구현 방법 소개

![21](./Docs/README/21.png)
![22](./Docs/README/22.png)
![23](./Docs/README/23.png)
![24](./Docs/README/24.png)

### 4-4. 한계 및 보완 방안

![25](./Docs/README/25.png)

Project Proposal에서 교수님이 2가지를 지적하였습니다.

1. Latency에 관련된 문제입니다. 이는 '오디오 인터페이스가 없을 경우 Latency 관리를 할 수 없어서 사용성이 매우 떨어질 수 있는데 이에 대한 고민이 필요하다.' 입니다.

    이 부분은, '구현 방법 소개'에서 설명한 방식들로 인하여 Latency가 발생하지 않습니다. Latency는 MIDI나 오디오 신호를 가상악기 혹은 이펙터로 보낸 후 연산과정을 거치고 다시 우리 귀로 들어오는 과정에서 발생하는 처리 과정상의 딜레이입니다.

    위 프로그램의 경우, MIDI 혹은 오디오 신호를 입력받은 뒤 후처리 과정을 거쳐 사운드를 내보내는 것이 아닌, 저장되어있는  사운드 소스를 불러와 별도의 연산과정을 거치지 않고 사운드를 출력하기 때문에, 키보드 자판만 이용할 경우 Latency가 발생하지 않습니다.

2. 'DAW와 연결하지 않고 사용 가능한 미디 장비 또는 Sampler들은 자체적으로 이펙터를 내장하고 있는 경우가 많아 가능하면 이러한 기능도 포함해 보는 것을 추천한다.' 입니다.

    이 부분은, 입문자분들도 쉽고 재밌게 사용할 수 있는 프로그램을 만들자는 저희의 프로그램 개발 의도와 맞지 않기 때문에 배제하였습니다. 저희는 입문자 분들에게 기술적으로 어려울 수 있는 '외장악기와의 연결', ‘이펙터 적용’, ‘사운드 파형 편집’ 기능 등은 그 난이도로 인하여 프로그램 계획시 고려하지 않았습니다.

![26](./Docs/README/26.png)

키보드 런치 패드에는 몇가지 한계점이 있습니다.

1. 'BANK Button' `Color`와 `NonClickColor` 변경 불가능. ('PLAY Button' 및 'MENU Button'은 변경 가능.)

    'BANK Button'의 색상 지정 방식이 'PLAY Button' 및 'MENU Button'과 달라, 시간 부족으로 인해 구현하지 못하였습니다.

2. Project Proposal에서 제안한 'PLAY Button: `Check`' 기능 미구현.

    이 기능은 해당하는 버튼이 어떠한 사운드 소스를 사용하는지 파일명을 확인하는 기능입니다. 구현 방식의 문제로 상당한 렉을 동반하여 구현하지 못하였습니다. 이 기능은 훗날 'Hovering' 기능으로도 구현할 예정으로, 해당 버튼에 마우스를 갖다 댔을 때 어떤 사운드소스를 이용하고 있는지 바로 확인할 수 있게 할 것입니다.

3. API 미사용.

    SoundCloud API를 이용하려고 했지만, SoundCloud가 API Key 제공을 막아 이용이 불가능헸습니다. 다른 음악 관련 API를 모색해 보았지만 마땅한 곳이 없어 API는 구현하지 못하였습니다.

4. 틱노이즈(잡음) 발생.

    파일을 Load 하거나 BANK를 바꾸는 경우, 매번은 아니지만 가끔씩 틱노이즈(잡음)이 발생하는 경우가 있습니다. 이 경우는 사운드 소스 자체의 문제도 있지만, 그렇지 않은 경우의 원인은 확실히 밝혀내지 못하였습니다.
